
{% extends 'base.html' %}
 
{% block title %}
百度云下载工具
{% endblock %}
 
{% block content %}
	<br />
	<div class="container">
		<ol id="breadcrumb" class="breadcrumb">
			<!--  breadcrumb  -->
		</ol>

		<div class="container">
			<h4>文件下载</h4>
			<p>文件名：{{ file_info['server_filename'] }}</p>
			<p>大小：
				{% if file_info['size'] < 1024 %}
				{{ (file_info['size'] / 1024) | round(2) }} B
				{% elif file_info['size'] < (1024 * 1024) %}
				{{ (file_info['size'] / 1024) | round(2) }} KB
				{% elif file_info['size'] < (1024 * 1024 * 1024) %}
				{{ (file_info['size'] / (1024 * 1024)) | round(2) }} M
				{% else %}
				{{ (file_info['size'] / (1024 * 1024 * 1024)) | round(2) }} G
				{% endif %}
			</p>
			<input type="button" class="btn btn-default" onclick="javascript:download();" value="下载">
		</div>
	</div>
	
	
	
{% endblock %}

{% block js %}
	<script>
	var file_href = "";

	$(document).ready(function(){
		{% autoescape false %}
		var file = {{ file }};
		{% endautoescape %}

		if (file.length > 0){
			for(var i=0;i<file.length;i++){
				file_href += file[i];
				if (file_href == '/'){
					$("#breadcrumb").append("<li><a href=\"/disk\">首页</a></li>");
				}else{
					if (i == (file.length - 1)){
						$("#breadcrumb").append("<li>" + file[i] + "</a></li>");
					}else{
						$("#breadcrumb").append("<li><a href=\"/disk?file=" + file_href + "\">" + file[i] + "</a></li>");
					}
				}
			}
		}
    });
    function download(){

    	$.ajax({
			type: "POST",
			url: '/download',
			data: {
				'file': file_href
			},
			success: function(result) {
				if (result.success == 1) {

				}
			}
		});
    }
	</script>
{% endblock %}